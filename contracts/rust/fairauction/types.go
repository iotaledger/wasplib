// Copyright 2020 IOTA Stiftung
// SPDX-License-Identifier: Apache-2.0

// (Re-)generated by schema tool
// >>>> DO NOT CHANGE THIS FILE! <<<<
// Change the json schema instead

package fairauction

import "github.com/iotaledger/wasp/packages/vm/wasmlib"

type Auction struct {
	Color         wasmlib.ScColor   // color of tokens for sale
	Creator       wasmlib.ScAgentID // issuer of start_auction transaction
	Deposit       int64             // deposit by auction owner to cover the SC fees
	Description   string            // auction description
	Duration      int32             // auction duration in minutes
	HighestBid    int64             // the current highest bid amount
	HighestBidder wasmlib.ScAgentID // the current highest bidder
	MinimumBid    int64             // minimum bid amount
	NumTokens     int64             // number of tokens for sale
	OwnerMargin   int64             // auction owner's margin in promilles
	WhenStarted   int64             // timestamp when auction started
}

func NewAuctionFromBytes(bytes []byte) *Auction {
	decode := wasmlib.NewBytesDecoder(bytes)
	data := &Auction{}
	data.Color = decode.Color()
	data.Creator = decode.AgentID()
	data.Deposit = decode.Int64()
	data.Description = decode.String()
	data.Duration = decode.Int32()
	data.HighestBid = decode.Int64()
	data.HighestBidder = decode.AgentID()
	data.MinimumBid = decode.Int64()
	data.NumTokens = decode.Int64()
	data.OwnerMargin = decode.Int64()
	data.WhenStarted = decode.Int64()
	decode.Close()
	return data
}

func (o *Auction) Bytes() []byte {
	return wasmlib.NewBytesEncoder().
		Color(o.Color).
		AgentID(o.Creator).
		Int64(o.Deposit).
		String(o.Description).
		Int32(o.Duration).
		Int64(o.HighestBid).
		AgentID(o.HighestBidder).
		Int64(o.MinimumBid).
		Int64(o.NumTokens).
		Int64(o.OwnerMargin).
		Int64(o.WhenStarted).
		Data()
}

type ImmutableAuction struct {
	objID int32
	keyID wasmlib.Key32
}

func (o ImmutableAuction) Exists() bool {
	return wasmlib.Exists(o.objID, o.keyID, wasmlib.TYPE_BYTES)
}

func (o ImmutableAuction) Value() *Auction {
	return NewAuctionFromBytes(wasmlib.GetBytes(o.objID, o.keyID, wasmlib.TYPE_BYTES))
}

type MutableAuction struct {
	objID int32
	keyID wasmlib.Key32
}

func (o MutableAuction) Exists() bool {
	return wasmlib.Exists(o.objID, o.keyID, wasmlib.TYPE_BYTES)
}

func (o MutableAuction) SetValue(value *Auction) {
	wasmlib.SetBytes(o.objID, o.keyID, wasmlib.TYPE_BYTES, value.Bytes())
}

func (o MutableAuction) Value() *Auction {
	return NewAuctionFromBytes(wasmlib.GetBytes(o.objID, o.keyID, wasmlib.TYPE_BYTES))
}

type Bid struct {
	Amount    int64 // cumulative amount of bids from same bidder
	Index     int32 // index of bidder in bidder list
	Timestamp int64 // timestamp of most recent bid
}

func NewBidFromBytes(bytes []byte) *Bid {
	decode := wasmlib.NewBytesDecoder(bytes)
	data := &Bid{}
	data.Amount = decode.Int64()
	data.Index = decode.Int32()
	data.Timestamp = decode.Int64()
	decode.Close()
	return data
}

func (o *Bid) Bytes() []byte {
	return wasmlib.NewBytesEncoder().
		Int64(o.Amount).
		Int32(o.Index).
		Int64(o.Timestamp).
		Data()
}

type ImmutableBid struct {
	objID int32
	keyID wasmlib.Key32
}

func (o ImmutableBid) Exists() bool {
	return wasmlib.Exists(o.objID, o.keyID, wasmlib.TYPE_BYTES)
}

func (o ImmutableBid) Value() *Bid {
	return NewBidFromBytes(wasmlib.GetBytes(o.objID, o.keyID, wasmlib.TYPE_BYTES))
}

type MutableBid struct {
	objID int32
	keyID wasmlib.Key32
}

func (o MutableBid) Exists() bool {
	return wasmlib.Exists(o.objID, o.keyID, wasmlib.TYPE_BYTES)
}

func (o MutableBid) SetValue(value *Bid) {
	wasmlib.SetBytes(o.objID, o.keyID, wasmlib.TYPE_BYTES, value.Bytes())
}

func (o MutableBid) Value() *Bid {
	return NewBidFromBytes(wasmlib.GetBytes(o.objID, o.keyID, wasmlib.TYPE_BYTES))
}
